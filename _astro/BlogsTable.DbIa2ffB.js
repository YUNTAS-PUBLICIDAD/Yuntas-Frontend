import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as m}from"./index.ai7qpRr1.js";import{a as _,e as v}from"./index.DG4OwnQQ.js";import{g as j,c as N}from"./config.DK3spbgR.js";import"./iconBase.CsihB_xR.js";const y=()=>{const[p,o]=m.useState(!1),[a,r]=m.useState({titulo:"",parrafo:"",descripcion:"",imagen_principal:null,titulo_blog:"",subtitulo_beneficio:"",url_video:"",titulo_video:"",imagenes:[{url_imagen:null,parrafo_imagen:""},{url_imagen:null,parrafo_imagen:""}]}),s=n=>{r({...a,[n.target.name]:n.target.value})},g=n=>{n.target.files&&n.target.files[0]&&r({...a,imagen_principal:n.target.files[0]})},f=(n,t)=>{if(n.target.files&&n.target.files[0]){const l=[...a.imagenes];l[t]={...l[t],url_imagen:n.target.files[0]},r({...a,imagenes:l})}},x=(n,t)=>{const l=[...a.imagenes];l[t]={...l[t],parrafo_imagen:n.target.value},r({...a,imagenes:l})},c=()=>{o(!1),r({titulo:"",parrafo:"",descripcion:"",imagen_principal:null,titulo_blog:"",subtitulo_beneficio:"",url_video:"",titulo_video:"",imagenes:[{url_imagen:null,parrafo_imagen:""},{url_imagen:null,parrafo_imagen:""}]})},h=async n=>{if(n.preventDefault(),!a.titulo||!a.parrafo||!a.descripcion||!a.subtitulo_beneficio||!a.titulo_blog||!a.titulo_video||!a.url_video||!a.imagen_principal||!a.imagenes||a.imagenes.some(t=>!t.url_imagen)){alert("⚠️ Todos los campos son obligatorios.");return}try{const t=localStorage.getItem("token"),l=new FormData;l.append("titulo",a.titulo),l.append("parrafo",a.parrafo),l.append("descripcion",a.descripcion),l.append("subtitulo_beneficio",a.subtitulo_beneficio),l.append("titulo_blog",a.titulo_blog),l.append("titulo_video",a.titulo_video),l.append("url_video",a.url_video),a.imagenes.forEach((u,b)=>{u.url_imagen&&l.append(`imagenes[${b}][url_imagen]`,u.url_imagen),l.append(`imagenes[${b}][parrafo_imagen]`,u.parrafo_imagen)}),l.append("imagen_principal",a.imagen_principal);const i=await fetch(j(N.endpoints.blogs.create),{method:"POST",body:l,headers:{Authorization:`Bearer ${t}`}}),d=await i.json();console.log("Respuesta del servidor:",d),i.ok?(alert("✅ Blog añadido exitosamente"),c()):alert(`❌ Error: ${d.message}`)}catch(t){console.error("Error al enviar los datos:",t),alert(`❌ Error: ${t}`)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o(!0),className:"mt-4 bg-blue-950 hover:bg-blue-950 text-white text-lg px-10 py-1.5 rounded-full flex items-center gap-2",children:"Añadir Blog"}),p&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"h-3/4 overflow-y-scroll bg-blue-950 text-white px-10 py-8 rounded-4xl w-3/5",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"AÑADIR BLOG"}),e.jsxs("form",{encType:"multipart/form-data",onSubmit:h,className:"grid grid-cols-2 gap-4 gap-x-12",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Título"}),e.jsx("input",{type:"text",name:"titulo",value:a.titulo,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Párrafo"}),e.jsx("input",{type:"text",name:"parrafo",value:a.parrafo,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"Descripción"}),e.jsx("input",{type:"text",name:"descripcion",value:a.descripcion,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"Subtítulo Beneficio"}),e.jsx("input",{type:"text",name:"subtitulo_beneficio",value:a.subtitulo_beneficio,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Título Blog"}),e.jsx("input",{type:"text",name:"titulo_blog",value:a.titulo_blog,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Título Video"}),e.jsx("input",{type:"text",name:"titulo_video",value:a.titulo_video,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"URL del Video"}),e.jsx("input",{type:"text",name:"url_video",value:a.url_video,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"Imagen Principal"}),e.jsx("input",{type:"file",accept:"image/png, image/jpeg, image/jpg",name:"imagen_principal",onChange:g,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),a.imagenes.map((n,t)=>e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{className:"block",children:["Imagen ",t+1]}),e.jsx("input",{type:"file",accept:"image/*",onChange:l=>{f(l,t)},required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"}),e.jsx("textarea",{onChange:l=>{x(l,t)},required:!0,placeholder:"Descripción de la imagen...",className:"w-full bg-white outline-none p-2 rounded-md text-black mt-2 min-h-36"})]},t)),e.jsxs("div",{className:"flex gap-2 mt-8",children:[e.jsx("button",{type:"submit",className:"admin-act-btn",children:"Añadir Blog"}),e.jsx("button",{onClick:c,type:"button",className:"cancel-btn",children:"Cancelar"})]})]})]})})]})},A=()=>{const[p,o]=m.useState([]),[a,r]=m.useState(1),s=10;m.useEffect(()=>{(async()=>{try{const i=await(await fetch(j(N.endpoints.blogs.list))).json();console.log("Datos recibidos:",i),o(i.data||[])}catch(l){console.error("❌ Error al cargar datos:",l)}})()},[]);const g=a*s,f=g-s,x=p.slice(f,g),c=t=>{r(t)},h=Math.ceil(p.length/s),n=async t=>{const l=localStorage.getItem("token");if(window.confirm("¿Estás seguro de que deseas eliminar este elemento?"))try{(await fetch(j(N.endpoints.blogs.delete(t)),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}})).ok?(o(u=>u.filter(b=>b.id!==t)),alert("Blog eliminado exitosamente")):alert("Error al eliminar el Blog")}catch(d){console.error("Error al eliminar:",d),alert("Error al conectar con el servidor")}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-separate border-spacing-2",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-950 text-white",children:[e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"ID"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"TÍTULO"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"PÁRRAFO"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"DESCRIPCIÓN"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"IMAGEN"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"ACCIÓN"})]})}),e.jsx("tbody",{children:x.length>0?x.map(t=>e.jsxs("tr",{className:`text-center ${t.id%2===0?"bg-gray-100":"bg-gray-300"}`,children:[e.jsx("td",{className:"px-4 font-bold rounded-xl",children:t.id}),e.jsx("td",{className:"px-4 font-bold rounded-xl",children:t.titulo}),e.jsx("td",{className:"px-4 rounded-xl",children:t.parrafo}),e.jsx("td",{className:"px-4 rounded-xl",children:t.descripcion}),e.jsx("td",{className:"px-4 rounded-xl",children:e.jsx("img",{src:t.imagenPrincipal,alt:t.titulo,className:"w-16 h-16 rounded-md mx-auto"})}),e.jsx("td",{className:"px-4 rounded-xl",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{className:"p-2 text-red-600 hover:text-red-800 transition",title:"Eliminar",onClick:()=>n(t.id),children:e.jsx(_,{size:18})}),e.jsx("button",{className:"p-2 text-yellow-600 hover:text-yellow-800 transition",title:"Confirmar",children:e.jsx(v,{size:18})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:"Cargando datos..."})})})]})}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:()=>c(a-1),disabled:a===1,className:"px-4 py-2 bg-blue-950 text-white rounded-md disabled:opacity-50",children:"Anterior"}),e.jsx("span",{className:"mx-4 self-center",children:`Página ${a} de ${h}`}),e.jsx("button",{onClick:()=>c(a+1),disabled:a===h,className:"px-4 py-2 bg-blue-950 text-white rounded-md disabled:opacity-50",children:"Siguiente"})]}),e.jsx(y,{})]})};export{A as default};
