import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.Be8AcK8B.js";import{b as O,g as z}from"./imageHelpers.2wvKHwk-.js";import{g as U,c as $}from"./config.CelHcebK.js";import{o as q,s as B}from"./types.By9teAtI.js";const G=({producto:s})=>{console.log("üé¥ ProductCard recibi√≥ producto:",s);const x=O(s.imagen_principal),i=s.text_alt_principal||"Imagen del producto",u=s.title||s.titulo||s.nombre||"Producto sin t√≠tulo",m=s.link;console.log("üñºÔ∏è Imagen URL calculada:",x),console.log("üìù T√≠tulo calculado:",u),console.log("üîó Link del producto:",m);const w=p=>{p.preventDefault(),window.location.href=`/products/${m}`};return e.jsxs("a",{href:`/products/${m}`,onClick:w,className:`block max-w-lg flex flex-col w-max-lg items-center 
      hover:scale-105 transition-all duration-200 
      cursor-pointer group mb-7 rounded-xl
      shadow-xl`,title:u,children:[e.jsx("div",{className:"block max-w-lg bg-white rounded-t-xl shadow-lg overflow-hidden group mb-2 ",children:e.jsx("div",{className:"relative aspect-[4/3] w-full ",children:x?e.jsx("img",{className:"w-full h-full object-cover object-center ",src:x,alt:i,title:z(x,u),loading:"lazy"}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 text-xl font-bold",children:"Sin imagen"})})})}),e.jsx("div",{className:"p-4   ",children:e.jsx("p",{className:"text-left text-gray-900 text-sm font-semibold uppercase tracking-wider",children:u})})]})},H=({products:s,onFilteredProducts:x})=>{const[i,u]=r.useState(""),[m,w]=r.useState([]),[p,v]=r.useState(!1),S=r.useRef(null),j=()=>{const l=new Set;return s.forEach(t=>{const o=t.title||t.titulo||t.nombre||"";o.trim()&&l.add(o.trim())}),Array.from(l)},g=l=>{if(l.length===0)return[];const t=j(),o=l.toLowerCase();return t.filter(N=>N.toLowerCase().includes(o)).sort((N,d)=>{const f=N.toLowerCase(),L=d.toLowerCase();return f===o?-1:L===o?1:f.startsWith(o)&&!L.startsWith(o)?-1:L.startsWith(o)&&!f.startsWith(o)?1:f.indexOf(o)-L.indexOf(o)}).slice(0,6)},h=l=>{if(!l.trim())return s;const t=l.toLowerCase();return s.filter(o=>(o.title||o.titulo||o.nombre||"").toLowerCase().includes(t))};r.useEffect(()=>{const l=h(i);if(x(l),i.length>0){const t=g(i);w(t),v(t.length>0)}else w([]),v(!1)},[i,s]),r.useEffect(()=>{const l=t=>{S.current&&!S.current.contains(t.target)&&v(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const y=l=>{const t=l.target.value;u(t)},M=l=>{u(l),v(!1)},k=()=>{m.length>0&&i.length>0&&v(!0)},P=()=>{u(""),v(!1)},b=()=>{v(!1)},E=l=>{l.key==="Enter"&&(l.preventDefault(),b())};return e.jsxs("div",{className:" w-full relative mb-3",ref:S,children:[e.jsx("div",{className:"relative w-full mb-3",children:e.jsxs("div",{className:"relative  w-full",children:[e.jsx("input",{type:"text",value:i,onChange:y,onFocus:k,onKeyDown:E,placeholder:"Buscar productos...",className:`w-full bg-white border-2 border-[#23c1de] 
            placeholder-gray-400
             px-12 pr-32 py-4 pr-16 rounded-2xl text-gray-400 text-xl 
             focus:outline-none focus:border-[#23c1de] focus:ring-2 
             focus:ring-[#23c1de] transition-all duration-300 
             shadow-xl `}),e.jsxs("div",{className:"absolute  top-1/2 transform -translate-y-1/2 flex items-center space-x-2 px-5  ",children:[!i&&e.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i&&e.jsx("button",{onClick:P,className:"w-6 h-6 text-gray-400 hover:text-white transition-colors duration-200 hover:scale-110 ",title:"Limpiar b√∫squeda",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("button",{onClick:b,className:`bg-[#23c1de] text-white font-semibold 
                          py-2 px-6 rounded-full text-base
                          hover:bg-[#1faac7] transition-colors duration-200
                          focus:outline-none focus:ring-2 focus:ring-offset-2
                          focus:ring-[#23c1de]`,children:"Buscar"})})]})}),p&&m.length>0&&e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-br from-gray-800 to-gray-900 border-2 border-gray-700 rounded-2xl shadow-2xl z-50 max-h-64 overflow-y-auto backdrop-blur-sm",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"text-xs text-cyan-400 px-4 py-2 font-bold uppercase tracking-wider border-b border-gray-700 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsxs("span",{children:["Sugerencias (",m.length,")"]})]}),m.map((l,t)=>e.jsxs("button",{onClick:()=>M(l),className:"w-full text-left px-4 py-3 hover:bg-gray-700/50 rounded-xl text-white transition-all duration-200 flex items-center space-x-3 group hover:scale-[1.02] hover:border-l-2 hover:border-cyan-400",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-cyan-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{className:"text-sm font-medium group-hover:text-cyan-100 transition-colors",children:l})]},t))]})})})]})},R=[{titulo:"¬°Tu marca brillando como se merece!"}],W=["Explorar opciones"],K=q({nombre:B().min(1,"El nombre es obligatorio").max(100,"El nombre no puede exceder 100 caracteres").regex(/^[a-zA-Z√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë√º√ú\s]+$/,"El nombre solo puede contener letras y espacios"),email:B().min(1,"El email es obligatorio").email("Formato de correo inv√°lido").max(100,"El email no puede exceder 100 caracteres"),telefono:B().regex(/^[0-9]{9}$/,"El celular debe tener exactamente 9 d√≠gitos")}),X=5e3,J=({producto:s})=>{const x=r.useRef(null),[i,u]=r.useState(!1),[m,w]=r.useState(!1),p=s?.id,v=r.useMemo(()=>{const t=Math.floor(Math.random()*R.length);return R[t]},[]),S=r.useMemo(()=>{const t=Math.floor(Math.random()*W.length);return W[t]},[]),[j,g]=r.useState({nombre:"",telefono:"",email:"",producto_id:p||""}),[h,y]=r.useState({}),[M,k]=r.useState(!1),[P,b]=r.useState("");r.useEffect(()=>{const t=setTimeout(()=>u(!0),X);return()=>clearTimeout(t)},[]),r.useEffect(()=>{g(t=>({...t,producto_id:p||""}))},[p]);const E=()=>{w(!0),setTimeout(()=>{u(!1),w(!1),g({nombre:"",telefono:"",email:"",producto_id:p||""}),y({}),b("")},300)};r.useEffect(()=>{const t=c=>{x.current&&!x.current.contains(c.target)&&E()},o=c=>{c.key==="Escape"&&E()};return i&&(document.addEventListener("mousedown",t),document.addEventListener("keydown",o)),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("keydown",o)}},[i]);const l=async t=>{t.preventDefault(),y({}),b("");const o=K.safeParse(j);if(!o.success){const c={};o.error.errors.forEach(N=>{c[N.path[0]]=N.message}),y(c);return}k(!0);try{const c=new FormData;c.append("name",o.data.nombre),c.append("email",o.data.email),c.append("celular",o.data.telefono),c.append("producto_id",j.producto_id);const N=await fetch(U($.endpoints.productos.info),{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:c});let d={};try{const f=await N.text();f&&(d=JSON.parse(f))}catch(f){console.error("[Emergente] Error parsing response:",f)}if(!N.ok){if(N.status===422&&d.errors){const f={};d.errors.name&&(f.nombre=Array.isArray(d.errors.name)?d.errors.name[0]:d.errors.name),d.errors.email&&(f.email=Array.isArray(d.errors.email)?d.errors.email[0]:d.errors.email),d.errors.celular&&(f.telefono=Array.isArray(d.errors.celular)?d.errors.celular[0]:d.errors.celular),y(f);return}throw new Error(d.message||`Error ${N.status}: ${N.statusText}`)}b("Informaci√≥n enviada con √©xito"),g({nombre:"",telefono:"",email:"",producto_id:p||""}),setTimeout(()=>{E(),b("")},2e3)}catch(c){console.error("[Emergente] Error:",c),c.name==="TypeError"&&(c.message.includes("fetch")||c.message.includes("CORS"))?y({general:"Error de conexi√≥n con el servidor. Por favor intenta nuevamente."}):c.message&&c.message.includes("configuraci√≥n del servidor")?y({general:"Error de configuraci√≥n del servidor. Contacta al administrador."}):y({general:c.message||"Error desconocido al enviar la informaci√≥n."})}finally{k(!1)}};return i?e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center px-4",children:e.jsxs("div",{ref:x,className:`flex flex-col sm:flex-row sm:gap-[1px] rounded-3xl shadow-xl w-[90vw] sm:w-full max-w-2xl max-h-[90vh] overflow-hidden bg-white relative ${m?"animate-slideOut":"animate-slideIn"}`,style:{border:"3px solid #e5e7eb"},children:[e.jsxs("div",{className:"w-full sm:w-[60%] relative",children:[e.jsx("div",{className:"w-full h-[250px] sm:h-full relative sm:pt-2 sm:pb-2 sm:pl-2 sm:pr-[1px]",children:e.jsxs("div",{className:"w-full h-full clip-vase overflow-hidden rounded-2xl relative",children:[e.jsx("img",{src:"images/Productos.webp",alt:"Popup",title:"Popup",className:"w-full h-full object-cover object-center"}),e.jsx("div",{className:"absolute inset-0 bg-black/10 sm:bg-transparent"})]})}),e.jsx("button",{onClick:E,"aria-label":"Cerrar modal",className:"absolute top-3 right-3 bg-white/90 hover:bg-white text-gray-600 rounded-full w-8 h-8 flex items-center justify-center transition-colors cursor-pointer text-sm z-10 shadow-sm sm:hidden",children:"‚úï"})]}),e.jsxs("div",{className:"w-full sm:w-[40%] pr-1 pt-10 pb-10 pl-1 relative flex flex-col justify-center",children:[e.jsx("button",{onClick:E,"aria-label":"Cerrar modal",className:"hidden sm:flex absolute top-3 right-3 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-full w-8 h-8 items-center justify-center transition-colors cursor-pointer text-sm z-10",children:"‚úï"}),e.jsxs("div",{className:"w-full text-center max-w-[250px] mx-auto",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("h2",{className:"text-lg sm:text-3xl font-extrabold font-montserrat leading-tight text-center pt-2 pb-6",style:{color:"#0E3F88"},children:v.titulo})}),e.jsxs("form",{className:"space-y-3 flex flex-col items-center",onSubmit:l,children:[e.jsx("input",{type:"text",value:j.nombre,onChange:t=>g({...j,nombre:t.target.value}),className:`w-[90%] mx-auto px-4 py-1 rounded-lg bg-[#EBEBEB] border-0 text-sm font-montserrat focus:ring-2 ${h.nombre?"ring-2 ring-red-400":"focus:ring-blue-500/20"}`,placeholder:"Nombre"}),h.nombre&&e.jsx("p",{className:"text-red-500 text-sm",children:h.nombre}),e.jsx("input",{type:"tel",value:j.telefono,onChange:t=>g({...j,telefono:t.target.value}),className:`w-[90%] mx-auto px-4 py-1 rounded-lg bg-[#EBEBEB] border-0 text-sm font-montserrat focus:ring-2 ${h.telefono?"ring-2 ring-red-400":"focus:ring-blue-500/20"}`,placeholder:"Tel√©fono",maxLength:9}),h.telefono&&e.jsx("p",{className:"text-red-500 text-sm",children:h.telefono}),e.jsx("input",{type:"email",value:j.email,onChange:t=>g({...j,email:t.target.value}),className:`w-[90%] mx-auto px-4 py-1 rounded-lg bg-[#EBEBEB] border-0 text-sm font-montserrat focus:ring-2 ${h.email?"ring-2 ring-red-400":"focus:ring-blue-500/20"}`,placeholder:"Correo"}),h.email&&e.jsx("p",{className:"text-red-500 text-sm",children:h.email}),h.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-600",children:h.general}),P&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-green-600",children:P}),e.jsx("div",{className:"w-full flex items-center justify-center",children:e.jsx("button",{type:"submit",disabled:M,className:"bg-[#172649] hover:bg-[#0f1a33] text-white font-montserrat font-semibold text-md pt-[5px] pr-[10px] pb-[5px] pl-[10px] rounded-lg transition-all disabled:opacity-50 mt-2 sm:mt-3",children:M?"Enviando...":S})})]})]})]})]})}):null},V=s=>s.reduce((x,i)=>{const u=i.seccion||"Sin Categor√≠a";return x[u]=(x[u]||0)+1,x},{});function se(){const[s,x]=r.useState([]),[i,u]=r.useState([]),[m,w]=r.useState(1),[p,v]=r.useState(1),[S,j]=r.useState(!0),[g,h]=r.useState(!1),[y,M]=r.useState(""),[k,P]=r.useState(null),b=6,[E,l]=r.useState(null);r.useEffect(()=>{(async()=>{j(!0);try{let a=[],C=1,A=!0;for(;A;){const D=`${$.apiUrl}${$.endpoints.productos.list}?page=${C}&per_page=50`,T=await(await fetch(D,{headers:{"Content-Type":"application/json",Accept:"application/json"}})).json();T&&Array.isArray(T.data)&&T.data.length>0?(a=[...a,...T.data],T.current_page<T.last_page?C++:A=!1):A=!1}console.log("Todos los productos obtenidos:",a.length),x(a),u(a),v(Math.ceil(a.length/b))}catch(a){console.error("Error fetching products:",a),x([]),u([])}finally{j(!1)}})()},[]);const t=n=>{u(n),h(n.length!==s.length||n.length===0&&s.length>0),w(1)},o=r.useMemo(()=>V(s),[s]),c=Object.keys(o).sort();r.useEffect(()=>{let n=[...s];if(k&&(n=n.filter(a=>(a.seccion||"Sin Categor√≠a")===k)),y){const a=y.toLowerCase();n=n.filter(C=>(C.nombre||C.titulo||"").toLowerCase().includes(a))}u(n),w(1)},[y,k,s]),r.useEffect(()=>{v(Math.ceil(i.length/b))},[i,b]);const d=(()=>{if(g)return i;{const n=(m-1)*b,a=n+b;return i.slice(n,a)}})();(n=>{const a=[];for(let C=0;C<n.length;C+=3)a.push(n.slice(C,C+3));return a})(d);const L=()=>{m>1&&w(m-1)},F=()=>{m<p&&w(m+1)},I=m>1&&!g,_=m<p&&!g;return r.useEffect(()=>{g||v(Math.ceil(i.length/b))},[i,g]),S?e.jsx("div",{className:"grid place-content-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mb-4"}),e.jsx("p",{className:"text-white text-2xl font-bold animate-pulse",children:"Cargando productos..."})]})}):e.jsxs("div",{children:[e.jsx(J,{producto:E}),e.jsxs("div",{className:"w-full bg-white",children:[e.jsxs("div",{className:`w-full 
       text-white px-6 md:px-12 py-8 flex
       flex-col sm:flex-row 
       items-center gap-8 mb-12 `,children:[e.jsx("h2",{className:`text-black
          text-3xl sm:text-4xl lg:text-4xl     
          font-bold uppercase tracking-wide
          flex-grow                           
          leading-tight text-center sm:text-left `,children:"Descubre la selecci√≥n que tenemos para ti"}),s.length>0&&e.jsx("div",{className:"w-full flex-grow ",children:e.jsx(H,{products:s,onFilteredProducts:t})})]}),s.length>0?e.jsxs("div",{className:"flex flex-col lg:flex-row gap-10 lg:gap-16",children:[e.jsxs("aside",{className:"w-full lg:w-1/4 xl:w-1/5 flex-shrink-0",children:[e.jsx("h3",{className:"text-2xl font-bold uppercase tracking-wider mb-4 text-black-800 dark:text-black-200",children:"CATEGOR√çA"}),e.jsxs("nav",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>P(null),className:`
                flex justify-between items-center w-full text-left font-bold
                ${k===null?"text-black-400 dark:text-black-400 rounded-2xl text-xl bg-[#d4efef] px-5 py-2 border-2 border-[#23c1de] shadow-l":"text-black-400 dark:text-black-300 hover:text-black"}
              `,children:e.jsxs("span",{children:["Todos los productos (",s.length,")"]})}),e.jsx("div",{className:"pl-4 border-l-2 border-[#23c1de]",children:c.map((n,a)=>e.jsxs("div",{className:`relative ${a===c.length-1?"pb-0":"pb-1"}`,children:[e.jsx("span",{className:"absolute left-[-16px] top-[12px] w-6 border-t-2 border-[#23c1de]"}),e.jsxs("button",{onClick:()=>P(n),className:`
                      block w-full text-left ml-4 py-1
                      ${k===n?"font-semibold text-black dark:text-black rounded-2xl text-xl bg-[#d4efef] px-4 py-2 border-2 border-[#23c1de] shadow-xl":"text-black-600 dark:text-black-300 hover:text-black"}
                    `,children:[n," (",o[n],")"]})]},n))})]})]}),e.jsxs("div",{className:"flex-grow w-full lg:w-0",children:[d.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8 items-center",children:d.map(n=>e.jsx(G,{producto:n},n.id||n.nombre))}):g?e.jsx("div",{className:"text-gray-600 dark:text-gray-300 text-center py-16",children:e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-2xl p-12 max-w-lg mx-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"No se encontraron productos"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-300 text-lg",children:["Intenta con otros t√©rminos de b√∫squeda o"," ",e.jsx("button",{onClick:()=>{u(s),h(!1)},className:"text-cyan-500 dark:text-cyan-400 hover:underline font-semibold",children:"ver todos los productos"})]})]})}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xl",children:"No hay productos disponibles"})}),p>1&&!g&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-center items-center mt-10 space-x-2 sm:space-x-4",children:[e.jsx("button",{"aria-label":"P√°gina anterior",title:"P√°gina anterior",onClick:L,disabled:!I,className:`px-2 py-1 transition-colors duration-200 cursor-pointer ${I?"text-blue-900 hover:text-blue-700":"text-gray-400 cursor-not-allowed"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})})}),e.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2",children:Array.from({length:p},(n,a)=>e.jsx("button",{"aria-label":`Ir a la p√°gina ${a+1}`,title:`Ir a la p√°gina ${a+1}`,onClick:()=>w(a+1),className:`
                        w-8 h-8 sm:w-10 sm:h-10   {/* Size */}
                        rounded-full             {/* Shape */}
                        flex items-center justify-center 
                        text-[20px] font-semibold 
                        transition-colors duration-200 cursor-pointer
                        ${a===m-1?"bg-blue-900 text-white":"bg-transparent text-blue-900 hover:bg-blue-100"}
                      `,children:a+1},a))}),e.jsx("button",{"aria-label":"P√°gina siguiente",title:"P√°gina siguiente",onClick:F,disabled:!_,className:`px-2 py-1 transition-colors duration-200 cursor-pointer  ${_?"text-blue-900 hover:text-blue-700":"text-gray-400 cursor-not-allowed"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})})]})]}):e.jsx("div",{className:"text-white text-center py-16",children:e.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-12 max-w-lg mx-auto",children:[e.jsx("svg",{className:"w-20 h-20 text-gray-400 mx-auto mb-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"No hay productos disponibles"}),e.jsx("p",{className:"text-gray-300 text-lg",children:"Intenta recargar la p√°gina o contacta al administrador"})]})})]})]})}export{se as default};
