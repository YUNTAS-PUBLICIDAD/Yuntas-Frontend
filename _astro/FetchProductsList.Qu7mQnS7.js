import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.Be8AcK8B.js";import{b as B,g as F}from"./imageHelpers.2wvKHwk-.js";import{c as M}from"./config.CelHcebK.js";const R=({producto:s})=>{console.log("üé¥ ProductCard recibi√≥ producto:",s);const u=B(s.imagen_principal),o=s.text_alt_principal||"Imagen del producto",c=s.title||s.titulo||s.nombre||"Producto sin t√≠tulo",i=s.link;console.log("üñºÔ∏è Imagen URL calculada:",u),console.log("üìù T√≠tulo calculado:",c),console.log("üîó Link del producto:",i);const h=b=>{b.preventDefault(),window.location.href=`/products/${i}`};return e.jsxs("a",{href:`/products/${i}`,onClick:h,className:`block max-w-lg flex flex-col w-max-lg items-center 
      hover:scale-105 transition-all duration-200 
      cursor-pointer group mb-8 rounded-xl
      shadow-xl `,title:c,children:[e.jsx("div",{className:"block max-w-lg bg-white rounded-t-xl shadow-lg overflow-hidden group mb-2 ",children:e.jsx("div",{className:"relative aspect-[4/3] w-full ",children:u?e.jsx("img",{className:"w-full h-full object-cover object-center ",src:u,alt:o,title:F(u,c),loading:"lazy"}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 text-xl font-bold",children:"Sin imagen"})})})}),e.jsx("div",{className:"p-4   ",children:e.jsx("p",{className:"text-left text-gray-900 text-sm font-semibold uppercase tracking-wider",children:c})})]})},_=({products:s,onFilteredProducts:u})=>{const[o,c]=l.useState(""),[i,h]=l.useState([]),[b,x]=l.useState(!1),y=l.useRef(null),C=()=>{const r=new Set;return s.forEach(a=>{const d=a.title||a.titulo||a.nombre||"";d.trim()&&r.add(d.trim())}),Array.from(r)},m=r=>{if(r.length===0)return[];const a=C(),d=r.toLowerCase();return a.filter(S=>S.toLowerCase().includes(d)).sort((S,E)=>{const j=S.toLowerCase(),w=E.toLowerCase();return j===d?-1:w===d?1:j.startsWith(d)&&!w.startsWith(d)?-1:w.startsWith(d)&&!j.startsWith(d)?1:j.indexOf(d)-w.indexOf(d)}).slice(0,6)},L=r=>{if(!r.trim())return s;const a=r.toLowerCase();return s.filter(d=>(d.title||d.titulo||d.nombre||"").toLowerCase().includes(a))};l.useEffect(()=>{const r=L(o);if(u(r),o.length>0){const a=m(o);h(a),x(a.length>0)}else h([]),x(!1)},[o,s]),l.useEffect(()=>{const r=a=>{y.current&&!y.current.contains(a.target)&&x(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const k=r=>{const a=r.target.value;c(a)},A=r=>{c(r),x(!1)},f=()=>{i.length>0&&o.length>0&&x(!0)},P=()=>{c(""),x(!1)},p=()=>{x(!1)},T=r=>{r.key==="Enter"&&(r.preventDefault(),p())};return e.jsxs("div",{className:" w-full relative mb-3",ref:y,children:[e.jsx("div",{className:"relative w-full mb-3",children:e.jsxs("div",{className:"relative  w-full",children:[e.jsx("input",{type:"text",value:o,onChange:k,onFocus:f,onKeyDown:T,placeholder:"Buscar productos...",className:`w-full bg-white border-2 border-[#23c1de] 
            placeholder-gray-400
             px-12 pr-32 py-4 pr-16 rounded-2xl text-gray-400 text-xl 
             focus:outline-none focus:border-[#23c1de] focus:ring-2 
             focus:ring-[#23c1de] transition-all duration-300 
             shadow-xl `}),e.jsxs("div",{className:"absolute  top-1/2 transform -translate-y-1/2 flex items-center space-x-2 px-5  ",children:[!o&&e.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),o&&e.jsx("button",{onClick:P,className:"w-6 h-6 text-gray-400 hover:text-white transition-colors duration-200 hover:scale-110 ",title:"Limpiar b√∫squeda",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("button",{onClick:p,className:`bg-[#23c1de] text-white font-semibold 
                          py-2 px-6 rounded-full text-base
                          hover:bg-[#1faac7] transition-colors duration-200
                          focus:outline-none focus:ring-2 focus:ring-offset-2
                          focus:ring-[#23c1de]`,children:"Buscar"})})]})}),b&&i.length>0&&e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-br from-gray-800 to-gray-900 border-2 border-gray-700 rounded-2xl shadow-2xl z-50 max-h-64 overflow-y-auto backdrop-blur-sm",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"text-xs text-cyan-400 px-4 py-2 font-bold uppercase tracking-wider border-b border-gray-700 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsxs("span",{children:["Sugerencias (",i.length,")"]})]}),i.map((r,a)=>e.jsxs("button",{onClick:()=>A(r),className:"w-full text-left px-4 py-3 hover:bg-gray-700/50 rounded-xl text-white transition-all duration-200 flex items-center space-x-3 group hover:scale-[1.02] hover:border-l-2 hover:border-cyan-400",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-cyan-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{className:"text-sm font-medium group-hover:text-cyan-100 transition-colors",children:r})]},a))]})})})]})},z=s=>s.reduce((u,o)=>{const c=o.seccion||"Sin Categor√≠a";return u[c]=(u[c]||0)+1,u},{});function K(){const[s,u]=l.useState([]),[o,c]=l.useState([]),[i,h]=l.useState(1),[b,x]=l.useState(1),[y,C]=l.useState(!0),[m,L]=l.useState(!1),[k,A]=l.useState(""),[f,P]=l.useState(null),p=6;l.useEffect(()=>{(async()=>{C(!0);try{let n=[],g=1,$=!0;for(;$;){const W=`${M.apiUrl}${M.endpoints.productos.list}?page=${g}&per_page=50`,v=await(await fetch(W,{headers:{"Content-Type":"application/json",Accept:"application/json"}})).json();v&&Array.isArray(v.data)&&v.data.length>0?(n=[...n,...v.data],v.current_page<v.last_page?g++:$=!1):$=!1}console.log("Todos los productos obtenidos:",n.length),u(n),c(n),x(Math.ceil(n.length/p))}catch(n){console.error("Error fetching products:",n),u([]),c([])}finally{C(!1)}})()},[]);const T=t=>{c(t),L(t.length!==s.length||t.length===0&&s.length>0),h(1)},r=l.useMemo(()=>z(s),[s]),a=Object.keys(r).sort();l.useEffect(()=>{let t=[...s];if(f&&(t=t.filter(n=>(n.seccion||"Sin Categor√≠a")===f)),k){const n=k.toLowerCase();t=t.filter(g=>(g.nombre||g.titulo||"").toLowerCase().includes(n))}c(t),h(1)},[k,f,s]),l.useEffect(()=>{x(Math.ceil(o.length/p))},[o,p]);const N=(()=>{if(m)return o;{const t=(i-1)*p,n=t+p;return o.slice(t,n)}})();(t=>{const n=[];for(let g=0;g<t.length;g+=3)n.push(t.slice(g,g+3));return n})(N);const E=()=>{i>1&&h(i-1)},j=()=>{i<b&&h(i+1)},w=i>1&&!m,I=i<b&&!m;return l.useEffect(()=>{m||x(Math.ceil(o.length/p))},[o,m]),y?e.jsx("div",{className:"grid place-content-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-b-2 border-cyan-400 mb-4"}),e.jsx("p",{className:"text-white text-2xl font-bold animate-pulse",children:"Cargando productos..."})]})}):e.jsxs("div",{className:"w-full bg-white",children:[e.jsxs("div",{className:`w-full 
       text-white px-6 md:px-12 py-8 flex
       flex-col sm:flex-row 
       items-center gap-8 mb-12 `,children:[e.jsx("h2",{className:`text-black
          text-3xl sm:text-4xl lg:text-4xl     
          font-bold uppercase tracking-wide
          flex-grow                           
          leading-tight text-center sm:text-left `,children:"Descubre la selecci√≥n que tenemos para ti"}),s.length>0&&e.jsx("div",{className:"w-full flex-grow ",children:e.jsx(_,{products:s,onFilteredProducts:T})})]}),s.length>0?e.jsxs("div",{className:"flex flex-col lg:flex-row gap-10 lg:gap-16",children:[e.jsxs("aside",{className:"w-full lg:w-1/4 xl:w-1/5 flex-shrink-0",children:[e.jsx("h3",{className:"text-2xl font-bold uppercase tracking-wider mb-4 text-gray-800 dark:text-gray-200",children:"CATEGOR√çA"}),e.jsxs("nav",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>P(null),className:`flex justify-between items-center
                   w-full text-left font-bold ${f===null?"text-gray-400 dark:text-cyan-400 rounded-2xl text-xl w-full bg-[#d4efef] px-4 border-2 border-[#23c1de] placeholder-gray-400 focus:outline-none focus:border-[#23c1de] focus:ring-2   focus:ring-[#23c1de] transition-all duration-300 shadow-xl ":"text-gray-400 dark:text-gray-300 hover:text-black dark:hover:text-white "}`,children:e.jsxs("span",{children:["Todos los productos (",s.length,")"]})}),e.jsx("div",{className:`pl-4 border-l-2 ${f===null?"border-cyan-400":"border-transparent"}`}),a.map(t=>e.jsx("div",{className:`pl-4 border-l-2 ${f===t?"border-cyan-400":"border-transparent"}`,children:e.jsxs("button",{onClick:()=>P(t),className:`block w-full text-left ${f===t?"text-gray-900 dark:text-white font-semibold":"text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white"}`,children:[t," (",r[t],")"]})},t))]})]}),e.jsxs("div",{className:"flex-grow w-full lg:w-0",children:[N.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8 items-center",children:N.map(t=>e.jsx(R,{producto:t},t.id||t.nombre))}):m?e.jsx("div",{className:"text-gray-600 dark:text-gray-300 text-center py-16",children:e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-2xl p-12 max-w-lg mx-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"No se encontraron productos"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-300 text-lg",children:["Intenta con otros t√©rminos de b√∫squeda o"," ",e.jsx("button",{onClick:()=>{c(s),L(!1)},className:"text-cyan-500 dark:text-cyan-400 hover:underline font-semibold",children:"ver todos los productos"})]})]})}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xl",children:"No hay productos disponibles"})}),b>1&&!m&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-center items-center mt-10 space-x-2 sm:space-x-4",children:[e.jsx("button",{"aria-label":"P√°gina anterior",title:"P√°gina anterior",onClick:E,disabled:!w,className:`px-2 py-1 transition-colors duration-200 cursor-pointer ${w?"text-blue-900 hover:text-blue-700":"text-gray-400 cursor-not-allowed"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})})}),e.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2",children:Array.from({length:b},(t,n)=>e.jsx("button",{"aria-label":`Ir a la p√°gina ${n+1}`,title:`Ir a la p√°gina ${n+1}`,onClick:()=>h(n+1),className:`
                        w-8 h-8 sm:w-10 sm:h-10   {/* Size */}
                        rounded-full             {/* Shape */}
                        flex items-center justify-center 
                        text-[20px] font-semibold 
                        transition-colors duration-200 cursor-pointer
                        ${n===i-1?"bg-blue-900 text-white":"bg-transparent text-blue-900 hover:bg-blue-100"}
                      `,children:n+1},n))}),e.jsx("button",{"aria-label":"P√°gina siguiente",title:"P√°gina siguiente",onClick:j,disabled:!I,className:`px-2 py-1 transition-colors duration-200 cursor-pointer  ${I?"text-blue-900 hover:text-blue-700":"text-gray-400 cursor-not-allowed"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})})]})]}):e.jsx("div",{className:"text-white text-center py-16",children:e.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-12 max-w-lg mx-auto",children:[e.jsx("svg",{className:"w-20 h-20 text-gray-400 mx-auto mb-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"No hay productos disponibles"}),e.jsx("p",{className:"text-gray-300 text-lg",children:"Intenta recargar la p√°gina o contacta al administrador"})]})})]})}export{K as default};
